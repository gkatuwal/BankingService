<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<title>Login Page</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

<script
	src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script
	src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>



<script type="text/javascript">
  $(document).ready(function() {
        $('#enquiryList').DataTable();
    } );
  </script>

<style>
.ffooter {
	position: fixed;
	left: 0;
	bottom: 0;
	width: 100%;
	background-color: red;
	color: white;
	text-align: center;
	height: 30px;
	background-color: #e9ffe7;
}
</style>

<script type="text/javascript">
 
        function toggleStatus(status,qid) {
        	//status="+status+"&qid="+qid is called query string
        	//window.location.href="/admin/security/uquestion?status="+status+"&qid="+qid;
         	   //make ajax call
     	        var promise= fetch("/v3/security/uquestion?status="+status+"&qid="+qid); 	
     	        promise.then(response=>response.json()).then(function(data){
     	        	console.log(data);
     	        	if('Yes'==status){
     	        		$("#statusButton").html('No');	
     	        	}else{
     	        		$("#statusButton").html('Yes');
     	        	}
     	        	
     	        	$("#mmessage").html(data.message);
     	        });
        
        }
 
         function openModal(){
        	 
        	  //$('#questionModal')  = this gives me object which id is questionModal
        	 $('#questionModal').modal('show');
         }
     	function updateModal(qid,question,status) {
    		console.log("qeid = " + qid);
    		console.log("Question = " + question);
    		console.log("status = " + status);
    	    		//<img  src=""
    		//JavaScript code to render the image
    		// $("#photophoto").attr("src","/admin/customers/photo?cid="+cid);
    		$("#qeid").val(qid);
    		$("#question").val(question);
    		$("#status").val(status);
    		$("#updateQuestionPopup").modal('show');

    	}

    	function deleteModal(qid,question) {
    		console.log("qid = " + qid);
    		console.log("Question = " + question);
    	    		//<img  src=""
    		//JavaScript code to render the image
    		// $("#photophoto").attr("src","/admin/customers/photo?cid="+cid);
    		$("#qid").val(qid);
    		$("#questions").val(question);
    		$("#deleteQuestionPopup").modal('show');

    	}
 
 
 </script>

</head>
<body>


	<header style="height: 30px; background-color: maroon; color: white;">
		Hello Mr. <span th:utext="${session.userSessionVO.username}"
			th:unless="${session == null}" style="font-weight: bold;"></span>

	</header>
	<div class="container">
		<h2>Employee Dashboard Page</h2>
		<button type="button" class="btn btn-primary">Customer
			Enquiry</button>
		<button type="button" class="btn btn-secondary">Lock/Unlock</button>
		<button type="button" class="btn btn-success">Customer
			Transaction</button>

		<button type="button" class="btn btn-danger">Check Book
			Request(s)</button>


		<a th:href="@{/customer/logout}">
			<button type="button" class="btn btn-warning">Logout</button>
		</a>
		<hr />
		<span th:utext="${error}" style="color: red; font-size: 18px;"
			id="mmessage"></span>
		<hr />
		<div style="width: 100%">
			<a th:onclick="|openModal()|" href="#">
				<button type="button" class="btn btn-warning">Add Security
					Question</button>
			</a>
			<hr />
			<table id="enquiryList" class="table table-striped table-bordered"
				style="width: 100%">
				<thead>
					<tr>
						<td>SNO</td>
						<td>Question</td>
						<td>Question Status</td>
						<td>Update</td>
						<td>Delete</td>
					</tr>
				</thead>
				<tbody>
					<tr th:each="questionsVO: ${questionsVOs}">
						<td th:text="${questionsVO.qid}" />
						<td th:text="${questionsVO.questions}" />

						<td><a
							th:onclick="|toggleStatus('${questionsVO.status}',${questionsVO.qid})|"
							style="cursor: pointer;">
								<button type="button" th:name="csaid"
									th:value="${questionsVO.status}" class="btn btn-primary">
									<span th:utext="${questionsVO.status}"
										style="color: black; font-size: 18px;" id="statusButton"></span>
								</button>
						</a></td>
						<td><a
							th:onclick="|updateModal(${questionsVO.qid},'${questionsVO.questions}','${questionsVO.status}')|"
							href="#"> <img th:src="@{/images/edit.png}" />
						</a></td>
						<td><a
							th:onclick="|deleteModal(${questionsVO.qid},'${questionsVO.questions}')|"
							href="#"> <img th:src="@{/images/delete.png}" />
						</a></td>

					</tr>
				</tbody>
			</table>
			<br />
			<hr />
		</div>
	</div>
	<footer class="ffooter"> </footer>


	<!-- The Modal -->
	<div class="modal" id="questionModal">
		<div class="modal-dialog">
			<div class="modal-content">
				<!-- Modal Header -->

				<form method="post" th:action="@{/admin/add/question}">
					<div class="modal-header">
						<h4 class="modal-title">
							<img th:src="@{/images/ques.png}" alt="page" /> Add new Question
						</h4>
						<button type="button" class="close" data-dismiss="modal">&times;</button>
					</div>

					<!-- Modal body -->
					<div class="modal-body">

						Enter Question <input type="text" name="question"
							class="form-control">

					</div>

					<!-- Modal footer -->
					<div class="modal-footer">
						<button type="submit" class="btn btn-danger">Add Question</button>
					</div>
				</form>
			</div>
		</div>
	</div>
		<!-- The Modal -->
	<div class="modal" id="updateQuestionPopup">
		<div class="modal-dialog">
			<div class="modal-content">
				<!-- Modal Header -->

				<form method="post" th:action="@{/admin/update/question}">
				<input type="hidden" name="qid" id="qeid" />
					<div class="modal-header">
						<h4 class="modal-title">Edit Question</h4>
						<button type="button" class="close" data-dismiss="modal">&times;</button>
					</div>
					<!-- Modal body -->
					<div class="modal-body">
						Question <input type="text" name="questions" id="question"
							class="form-control">
							Status <input type="text" name="status" id="status"
							class="form-control">
					</div>

					<!-- Modal footer -->
					<div class="modal-footer">
						<button type="submit" class="btn btn-danger">Update</button>
					</div>
				</form>
			</div>
		</div>
	</div>
			<!-- The Modal -->
	<div class="modal" id="deleteQuestionPopup">
		<div class="modal-dialog">
			<div class="modal-content">
				<!-- Modal Header -->

				<form method="post" th:action="@{/admin/delete/question}">
				<input type="hidden" name="id" id="qid" />
					<div class="modal-header">
						<h4 class="modal-title">Sure, You want to delete this Question?</h4>
						<button type="button" class="close" data-dismiss="modal">&times;</button>
					</div>
					<!-- Modal body -->
					<div class="modal-body">
						Question <input type="text" name="questions" id="questions"
							class="form-control">
						<hr />
					</div>

					<!-- Modal footer -->
					<div class="modal-footer">
						<button type="submit" class="btn btn-danger">Delete</button>
					</div>
				</form>
			</div>
		</div>
	</div>
	

</body>
</html>
